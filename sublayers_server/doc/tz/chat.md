
# Чат #

Свойства:

- history (30-50 сообщений) [todo: обсудить механику работы]

- список участников

- публичность (видно всем без приглашения)

- uri

- приглашения


Временный чат


Инициализация чата: 

- PublicChat:
	- Инициализируется автоматически (при создании соответствующих объектов город, группа и т.д.)

- PrivateChat		
	- Инициируется любым игроком, когда от него поступает соответствующий API-запрос: 
		- @privateChat {имя пользователя}
		- Кликнуть по не своей машинке и выбрать соответствующий пункт меню


Добавление участников: 

- PublicChat:
	- Игрок добавляется в этот чат автоматически, при выполнении соответствующего условия (заехал в область видимости города, зашел на рынок / в бар, вступил в группу и т.д.)

- PrivateChat:
	- При создании чата
	- По приглашению от любого игрока который уже находится в чате
	

Конструктор: [обсудить]


[toso: Исследовать возможность использования прикрутить джаббер]

		
Исключения участников из чата: 

- PublicChat:
	- Автоматически, если agent offline или при выполнении соответствующего условия (обратное по отношению к условию вступления в чат)

- PrivateChat:
	- Автоматически, если agent offline
	- По собственному желанию (соответствующий API-запрос)


Деструктор чата: 

- PublicChat:
	- При удалении инициирующего объекта

- PrivateChat:
	- При длинне списка участников равной 0
	

История чата: [обсудить]

- PublicChat, PrivateChat:
	- Необходимо хранить в каждом чате по 30-50 сообщений;

		
Итог: 

- Каждый Агент имеет список своих чатов

- Каждый Chat имеет список агентов-участников

- Отдельные сущности в игре имеют свои PublicChat (время жизни которых (чатов) совпадает со временем жизни сущности)

- Каждый Агент попадает в PublicChat автоматически и выйти из него может тоже только автоматически

- Каждый Агент имеет право создать PrivateChat (первый создающий чат Агент становится его единственным участником)

- Каждый Агент находящийся в PrivateChat имеет право выдать приглашение любому другому игроку (по имени Игрока или "по машинке" (клик на машинку на карте))

- Каждый Агент может как принять приглашение в PrivateChat так и отклонить его

- Каждый Агент находящийся в PrivateChat имеет возможность покинуть его (при выходе последнего Агента PrivateChat удаляется)

- При выходе Игрока в оффлайн он выходит из всех PrivateChat'ов
