<?xml version="1.0" encoding="utf-8" ?>
<c2eventsheet>
    <!--All the 'name' attributes are ignored by Construct 2 - they are there for readability only.-->
    <name>Event sheet 1</name>
    <events>
        <variable constant="0" name="LastClickX" sid="7615487379381014" static="0" type="number">0</variable>
        <variable constant="0" name="LastClickY" sid="169035614773773" static="0" type="number">0</variable>
        <event-group collapsed="1" description="" sid="9067377116177994" title="Startup and initialisation">
            <sub-events>
                <comment>On startup, tell the friendly turrets to aim for enemy bases, and enemy turrets to aim for friendly bases.</comment>
                <event-block sid="9801585050267084">
                    <conditions>
                        <condition id="-2" name="On start of layout" sid="9367449878697515" type="System" />
                    </conditions>
                    <actions>
                        <action behavior="Turret" id="1" name="Add object to target" sid="2271077195474519" type="FriendlyTurrets">
                            <param id="0" name="Target">EnemyBases</param>
                        </action>
                        <action behavior="Turret" id="1" name="Add object to target" sid="3033139396137642" type="EnemyTurrets">
                            <param id="0" name="Target">FriendlyBases</param>
                        </action>
                        <action behavior="Turret" id="1" name="Add object to target" sid="4469178886901621" type="Turret">
                            <param id="0" name="Target">FriendlyBases</param>
                        </action>
                    </actions>
                    <sub-events>
                        <comment>For the enemies marked as patrolling, send them off on a patrol after 2-25 seconds.</comment>
                        <event-block sid="6765874068424131">
                            <conditions>
                                <condition id="-8" name="Is boolean instance variable set" sid="5506876243779561" type="EnemyBases">
                                    <param id="0" name="Instance variable">IsPatrolling</param>
                                </condition>
                            </conditions>
                            <actions>
                                <action behavior="Timer" id="0" name="Start timer" sid="3257102111320553" type="EnemyBases">
                                    <param id="0" name="Duration">random(2, 25)</param>
                                    <param id="1" name="Type">0</param>
                                    <param id="2" name="Tag">&quot;patrol&quot;</param>
                                </action>
                            </actions>
                        </event-block>
                    </sub-events>
                </event-block>
                <comment>Whenever each unit&apos;s base is created (which includes every instance initially on the layout at startup), position its turret over the base and pin it so it follows along with the base. We also need both the turret and the base to store each other&apos;s UID, so we can find the associated object later on.</comment>
                <event-block sid="2496442280823173">
                    <conditions>
                        <condition id="-18" name="On created" sid="9115205636462788" type="Tank1Base" />
                    </conditions>
                    <actions>
                        <action id="-4" name="Set position to another object" sid="7028680558117771" type="Tank1Turret">
                            <param id="0" name="Object">Tank1Base</param>
                            <param id="1" name="Image point (optional)">0</param>
                        </action>
                        <action behavior="Pin" id="0" name="Pin to object" sid="2856419547246488" type="Tank1Turret">
                            <param id="0" name="Pin to">Tank1Base</param>
                            <param id="1" name="Mode">0</param>
                        </action>
                        <action id="-10" name="Set value" sid="4089676753000868" type="Tank1Base">
                            <param id="0" name="Instance variable">TurretUID</param>
                            <param id="1" name="Value">Tank1Turret.UID</param>
                        </action>
                        <action id="-10" name="Set value" sid="6195019082706329" type="Tank1Turret">
                            <param id="0" name="Instance variable">BaseUID</param>
                            <param id="1" name="Value">Tank1Base.UID</param>
                        </action>
                    </actions>
                </event-block>
                <event-block sid="2902237191386204">
                    <conditions>
                        <condition id="-18" name="On created" sid="3323878183526543" type="Enemy1Base" />
                    </conditions>
                    <actions>
                        <action id="-4" name="Set position to another object" sid="768211071491945" type="Enemy1Turret">
                            <param id="0" name="Object">Enemy1Base</param>
                            <param id="1" name="Image point (optional)">0</param>
                        </action>
                        <action behavior="Pin" id="0" name="Pin to object" sid="8192746078110451" type="Enemy1Turret">
                            <param id="0" name="Pin to">Enemy1Base</param>
                            <param id="1" name="Mode">0</param>
                        </action>
                        <action id="-10" name="Set value" sid="2802625996607865" type="Enemy1Base">
                            <param id="0" name="Instance variable">TurretUID</param>
                            <param id="1" name="Value">Enemy1Turret.UID</param>
                        </action>
                        <action id="-10" name="Set value" sid="6487474392533392" type="Enemy1Turret">
                            <param id="0" name="Instance variable">BaseUID</param>
                            <param id="1" name="Value">Enemy1Base.UID</param>
                        </action>
                    </actions>
                </event-block>
            </sub-events>
        </event-group>
        <event-group collapsed="1" description="Left clicking to move units to a destination" sid="9159341851032568" title="Player unit control">
            <sub-events>
                <comment>Store the last click position so we can tell the difference between a selection box drag and single click when the left mouse button is released.</comment>
                <event-block sid="1179971079378725">
                    <conditions>
                        <condition id="0" name="On click" sid="1841404932720768" type="Mouse">
                            <param id="0" name="Mouse button">0</param>
                            <param id="1" name="Click type">0</param>
                        </condition>
                    </conditions>
                    <actions>
                        <action id="-9" name="Set value" sid="712064386511624" type="System">
                            <param id="0" name="Variable">LastClickX</param>
                            <param id="1" name="Value">Mouse.X(&quot;Bases&quot;)</param>
                        </action>
                        <action id="-9" name="Set value" sid="2803511856018814" type="System">
                            <param id="0" name="Variable">LastClickY</param>
                            <param id="1" name="Value">Mouse.Y(&quot;Bases&quot;)</param>
                        </action>
                    </actions>
                </event-block>
                <comment>If the user releases the mouse, tell them to find a path to that location then move there. The cursor has to move less than 16 pixels for it to count as a click and not a selection box drag.</comment>
                <event-block sid="2424266692559247">
                    <conditions>
                        <condition id="3" name="On button released" sid="4147401483280524" type="Mouse">
                            <param id="0" name="Mouse button">0</param>
                        </condition>
                        <condition id="-8" name="Compare two values" sid="2654881225458803" type="System">
                            <param id="0" name="First value">distance(Mouse.X(&quot;Bases&quot;), Mouse.Y(&quot;Bases&quot;), LastClickX, LastClickY)</param>
                            <param id="1" name="Comparison">2</param>
                            <param id="2" name="Second value">16</param>
                        </condition>
                        <condition id="7" inverted="1" name="Cursor is over object" sid="1050114067706274" type="Mouse">
                            <param id="0" name="Object">FriendlyBases</param>
                        </condition>
                        <condition id="-8" name="Is boolean instance variable set" sid="6365922434491374" type="FriendlyBases">
                            <param id="0" name="Instance variable">IsSelected</param>
                        </condition>
                    </conditions>
                    <actions />
                    <sub-events>
                        <comment>We want to keep all our units in formation, instead of all piling on to the same point. So first we find the average of all the selected unit&apos;s positions. This gives us the mid-point of the selection. First we need to sum all the X and Y co-ordinates, then divide by the count to get the average.</comment>
                        <variable constant="0" name="SelectionMidpointX" sid="6781936523987247" static="0" type="number">0</variable>
                        <variable constant="0" name="SelectionMidpointY" sid="3322588607930246" static="0" type="number">0</variable>
                        <event-block sid="3003808253370082">
                            <conditions>
                                <condition id="-11" name="For Each" sid="5601141840231102" type="System">
                                    <param id="0" name="Object">FriendlyBases</param>
                                </condition>
                            </conditions>
                            <actions>
                                <action id="-10" name="Add to" sid="7491728291617766" type="System">
                                    <param id="0" name="Variable">SelectionMidpointX</param>
                                    <param id="1" name="Value">FriendlyBases.X</param>
                                </action>
                                <action id="-10" name="Add to" sid="3369258165190144" type="System">
                                    <param id="0" name="Variable">SelectionMidpointY</param>
                                    <param id="1" name="Value">FriendlyBases.Y</param>
                                </action>
                            </actions>
                        </event-block>
                        <comment>Now we&apos;ve summed, we divide by the count to get the mid-point of all the selected units. Then we tell the unit to move to the mouse, but keeping its relative position. This preserves the formation.</comment>
                        <event-block sid="6578267403205623">
                            <conditions />
                            <actions>
                                <action id="-9" name="Set value" sid="5341116745286072" type="System">
                                    <param id="0" name="Variable">SelectionMidpointX</param>
                                    <param id="1" name="Value">SelectionMidpointX / FriendlyBases.PickedCount</param>
                                </action>
                                <action id="-9" name="Set value" sid="6593070560678149" type="System">
                                    <param id="0" name="Variable">SelectionMidpointY</param>
                                    <param id="1" name="Value">SelectionMidpointY / FriendlyBases.PickedCount</param>
                                </action>
                                <action behavior="Pathfinding" id="0" name="Find path" sid="9766499848418235" type="FriendlyBases">
                                    <param id="0" name="X">Mouse.X(&quot;Bases&quot;) + (Self.X - SelectionMidpointX)</param>
                                    <param id="1" name="Y">Mouse.Y(&quot;Bases&quot;) + (Self.Y - SelectionMidpointY)</param>
                                </action>
                            </actions>
                        </event-block>
                    </sub-events>
                </event-block>
                <event-block sid="514207415207339">
                    <conditions>
                        <condition behavior="Pathfinding" id="0" name="On path found" sid="8321821825625413" type="FriendlyBases" />
                    </conditions>
                    <actions>
                        <action behavior="Pathfinding" id="1" name="Move along path" sid="1220649070629195" type="FriendlyBases" />
                    </actions>
                </event-block>
                <comment>If a turret has no target, rotate it back to face in the direction of the unit. Note Construct 2 doesn&apos;t normally know how to match up the FriendlyTurrets family to the associated FriendlyBases family. So to make sure this works per-unit, we loop each FriendlyTurret and specifically pick its associated base.</comment>
                <event-block sid="7046896209131613">
                    <conditions>
                        <condition behavior="Turret" id="0" inverted="1" name="Has target" sid="7793028890699309" type="FriendlyTurrets" />
                        <condition id="-11" name="For Each" sid="4762007704451782" type="System">
                            <param id="0" name="Object">FriendlyTurrets</param>
                        </condition>
                        <condition id="-14" name="Pick by unique ID" sid="1473946647105548" type="FriendlyBases">
                            <param id="0" name="Unique ID">FriendlyTurrets.BaseUID</param>
                        </condition>
                    </conditions>
                    <actions>
                        <action id="-20" name="Rotate toward angle" sid="4240295190834539" type="FriendlyTurrets">
                            <param id="0" name="Degrees">FriendlyTurrets.Turret.RotateSpeed * dt</param>
                            <param id="1" name="Angle">FriendlyBases.Angle</param>
                        </action>
                    </actions>
                </event-block>
                <comment>Normally lines of units snake along overlapping each other, which looks unrealistic. This is extremely difficult to get right, but this event implements an &quot;anti traffic jamming&quot; hack. If a unit is moving and there is another unit moving 40 pixels in front of it, the unit will slow down and also speed up the unit in front. This basically makes units wait for other units in front of them, so queues form. It doesn&apos;t stop units still overlapping or driving through each other, but it does look a little bit more realistic.&#x0D;&#x0A;&#x0D;&#x0A;Note in this event to tell apart the instances of the same object type, we take advantage of the fact Construct 2 picks instances for families separately to the object type. So in this case, FriendlyBases is remembering which instances match separately to Tank1Base, even though they refer to the same instances.</comment>
                <event-block sid="9845008589459932">
                    <conditions>
                        <condition behavior="Pathfinding" id="4" name="Is moving along path" sid="1974485894304094" type="FriendlyBases" />
                        <condition behavior="Pathfinding" id="6" name="Compare speed" sid="1257908269553713" type="FriendlyBases">
                            <param id="0" name="Comparison">4</param>
                            <param id="1" name="Speed">Self.Pathfinding.MaxSpeed / 4</param>
                        </condition>
                        <condition id="-11" name="For Each" sid="411395772856513" type="System">
                            <param id="0" name="Object">FriendlyBases</param>
                        </condition>
                        <condition id="-36" name="Pick overlapping point" sid="1589812698019903" type="System">
                            <param id="0" name="Object">Tank1Base</param>
                            <param id="1" name="X">FriendlyBases.X + cos(FriendlyBases.Angle) * 40</param>
                            <param id="2" name="Y">FriendlyBases.Y + sin(FriendlyBases.Angle) * 40</param>
                        </condition>
                        <condition behavior="Pathfinding" id="4" name="Is moving along path" sid="6827118817530815" type="Tank1Base" />
                    </conditions>
                    <actions>
                        <action behavior="Pathfinding" id="14" name="Set speed" sid="7506142387792049" type="FriendlyBases">
                            <param id="0" name="Speed">Self.Pathfinding.MaxSpeed / 4</param>
                        </action>
                        <action behavior="Pathfinding" id="14" name="Set speed" sid="1554043181788681" type="Tank1Base">
                            <param id="0" name="Speed">Self.Pathfinding.Speed + Self.Pathfinding.Acceleration * dt * 2</param>
                        </action>
                    </actions>
                </event-block>
            </sub-events>
        </event-group>
        <event-group collapsed="1" description="Handles both left-clicking to select individual units, and click-and-drag selection boxes" sid="6218055322036161" title="Player selecting units">
            <sub-events>
                <comment>Left click to add the unit to selection, and right click to unselect all.</comment>
                <event-block sid="3726682766314698">
                    <conditions>
                        <condition id="6" name="On object clicked" sid="9177420041428872" type="Mouse">
                            <param id="0" name="Mouse button">0</param>
                            <param id="1" name="Click type">0</param>
                            <param id="2" name="Object clicked">FriendlyBases</param>
                        </condition>
                    </conditions>
                    <actions>
                        <action id="-13" name="Set boolean" sid="217170246169846" type="FriendlyBases">
                            <param id="0" name="Instance variable">IsSelected</param>
                            <param id="1" name="Value">1</param>
                        </action>
                    </actions>
                </event-block>
                <event-block sid="8153279548452389">
                    <conditions>
                        <condition id="0" name="On click" sid="4249787431527583" type="Mouse">
                            <param id="0" name="Mouse button">2</param>
                            <param id="1" name="Click type">0</param>
                        </condition>
                    </conditions>
                    <actions>
                        <action id="-13" name="Set boolean" sid="1851321274335111" type="FriendlyBases">
                            <param id="0" name="Instance variable">IsSelected</param>
                            <param id="1" name="Value">0</param>
                        </action>
                    </actions>
                </event-block>
                <comment>If holding the left mouse button down and the cursor has moved more than 16 pixels, show a selection box.</comment>
                <event-block sid="853279581892255">
                    <conditions>
                        <condition id="2" name="Mouse button is down" sid="8418455466567298" type="Mouse">
                            <param id="0" name="Mouse button">0</param>
                        </condition>
                        <condition id="-8" name="Compare two values" sid="7139333259418963" type="System">
                            <param id="0" name="First value">distance(Mouse.X(&quot;Bases&quot;), Mouse.Y(&quot;Bases&quot;), LastClickX, LastClickY)</param>
                            <param id="1" name="Comparison">5</param>
                            <param id="2" name="Second value">16</param>
                        </condition>
                    </conditions>
                    <actions>
                        <action id="-15" name="Set visible" sid="9179487908724681" type="SelectionBox">
                            <param id="0" name="Visibility">1</param>
                        </action>
                        <action id="-3" name="Set position" sid="9384794953312746" type="SelectionBox">
                            <param id="0" name="X">min(Mouse.X(&quot;Bases&quot;), LastClickX)</param>
                            <param id="1" name="Y">min(Mouse.Y(&quot;Bases&quot;), LastClickY)</param>
                        </action>
                        <action id="-7" name="Set size" sid="6731475628571588" type="SelectionBox">
                            <param id="0" name="Width">abs(Mouse.X(&quot;Bases&quot;) - LastClickX)</param>
                            <param id="1" name="Height">abs(Mouse.Y(&quot;Bases&quot;) - LastClickY)</param>
                        </action>
                    </actions>
                </event-block>
                <event-block sid="1540049522846377">
                    <conditions>
                        <condition id="-22" name="Else" sid="4707586891308932" type="System" />
                    </conditions>
                    <actions>
                        <action id="-15" name="Set visible" sid="1274096068391291" type="SelectionBox">
                            <param id="0" name="Visibility">0</param>
                        </action>
                    </actions>
                </event-block>
                <comment>When releasing the left mouse button and the cursor has moved more than 16 pixels, make any units inside the selection box selected.</comment>
                <event-block sid="6356457613092448">
                    <conditions>
                        <condition id="3" name="On button released" sid="9131731803396952" type="Mouse">
                            <param id="0" name="Mouse button">0</param>
                        </condition>
                        <condition id="-8" name="Compare two values" sid="868973423636771" type="System">
                            <param id="0" name="First value">distance(Mouse.X(&quot;Bases&quot;), Mouse.Y(&quot;Bases&quot;), LastClickX, LastClickY)</param>
                            <param id="1" name="Comparison">5</param>
                            <param id="2" name="Second value">16</param>
                        </condition>
                    </conditions>
                    <actions>
                        <action id="-13" name="Set boolean" sid="5820310691053569" type="FriendlyBases">
                            <param id="0" name="Instance variable">IsSelected</param>
                            <param id="1" name="Value">0</param>
                        </action>
                    </actions>
                    <sub-events>
                        <event-block sid="6571895406082555">
                            <conditions>
                                <condition id="-1" name="Compare X" sid="5639487936342808" type="FriendlyBases">
                                    <param id="0" name="Comparison">5</param>
                                    <param id="1" name="X co-ordinate">SelectionBox.X</param>
                                </condition>
                                <condition id="-1" name="Compare X" sid="4312243012344021" type="FriendlyBases">
                                    <param id="0" name="Comparison">3</param>
                                    <param id="1" name="X co-ordinate">SelectionBox.X + SelectionBox.Width</param>
                                </condition>
                                <condition id="-2" name="Compare Y" sid="1878180194906869" type="FriendlyBases">
                                    <param id="0" name="Comparison">5</param>
                                    <param id="1" name="Y co-ordinate">SelectionBox.Y</param>
                                </condition>
                                <condition id="-2" name="Compare Y" sid="7646059355573521" type="FriendlyBases">
                                    <param id="0" name="Comparison">3</param>
                                    <param id="1" name="Y co-ordinate">SelectionBox.Y + SelectionBox.Height</param>
                                </condition>
                            </conditions>
                            <actions>
                                <action id="-13" name="Set boolean" sid="8620022952423794" type="FriendlyBases">
                                    <param id="0" name="Instance variable">IsSelected</param>
                                    <param id="1" name="Value">1</param>
                                </action>
                            </actions>
                        </event-block>
                    </sub-events>
                </event-block>
                <event-group description="Create a unit selection box 9-patch for every selected player unit, and position it over the unit." sid="1173358469440974" title="Unit selection boxes">
                    <sub-events>
                        <comment>We need to create a UnitSelectionBox for every selected unit. First count how many friendly units are selected using the PickedCount expression.</comment>
                        <variable constant="0" name="NumberSelected" sid="5787528179958634" static="0" type="number">0</variable>
                        <event-block sid="4378576241767043">
                            <conditions>
                                <condition id="-8" name="Is boolean instance variable set" sid="289334330260713" type="FriendlyBases">
                                    <param id="0" name="Instance variable">IsSelected</param>
                                </condition>
                            </conditions>
                            <actions>
                                <action id="-9" name="Set value" sid="351524994428543" type="System">
                                    <param id="0" name="Variable">NumberSelected</param>
                                    <param id="1" name="Value">FriendlyBases.PickedCount</param>
                                </action>
                            </actions>
                        </event-block>
                        <event-block sid="8468442250917351">
                            <conditions>
                                <condition id="-22" name="Else" sid="9355142077269749" type="System" />
                            </conditions>
                            <actions>
                                <action id="-9" name="Set value" sid="3520067703725249" type="System">
                                    <param id="0" name="Variable">NumberSelected</param>
                                    <param id="1" name="Value">0</param>
                                </action>
                            </actions>
                        </event-block>
                        <comment>If there are more selected units than UnitSelectionBox objects, create more UnitSelectionBox objects to make up the difference.</comment>
                        <event-block sid="5578223894700985">
                            <conditions>
                                <condition id="-14" name="Compare variable" sid="1740906322168787" type="System">
                                    <param id="0" name="Variable">NumberSelected</param>
                                    <param id="1" name="Comparison">4</param>
                                    <param id="2" name="Value">UnitSelectionBox.Count</param>
                                </condition>
                                <condition id="-12" name="Repeat" sid="7488980615084299" type="System">
                                    <param id="0" name="Count">NumberSelected - UnitSelectionBox.Count</param>
                                </condition>
                            </conditions>
                            <actions>
                                <action id="-3" name="Create object" sid="3113659328415529" type="System">
                                    <param id="0" name="Object to create">UnitSelectionBox</param>
                                    <param id="1" name="Layer">&quot;Turrets&quot;</param>
                                    <param id="2" name="X">-1000</param>
                                    <param id="3" name="Y">-1000</param>
                                </action>
                            </actions>
                        </event-block>
                        <comment>If there are fewer selected units than UnitSelectionBox objects, destroy UnitSelectionBox objects to make up the difference.</comment>
                        <event-block sid="1839028107001407">
                            <conditions>
                                <condition id="-14" name="Compare variable" sid="2056239967697771" type="System">
                                    <param id="0" name="Variable">NumberSelected</param>
                                    <param id="1" name="Comparison">2</param>
                                    <param id="2" name="Value">UnitSelectionBox.Count</param>
                                </condition>
                                <condition id="-12" name="Repeat" sid="1015064329698764" type="System">
                                    <param id="0" name="Count">UnitSelectionBox.Count - NumberSelected</param>
                                </condition>
                                <condition id="-13" name="Pick nth instance" sid="9753802999592972" type="System">
                                    <param id="0" name="Object">UnitSelectionBox</param>
                                    <param id="1" name="Instance">loopindex</param>
                                </condition>
                            </conditions>
                            <actions>
                                <action id="-9" name="Destroy" sid="505983896612214" type="UnitSelectionBox" />
                            </actions>
                        </event-block>
                        <comment>Due to the above two events, we now know there are an equal number of selected Friendly units, and UnitSelectionBox objects. So now we loop for each selected friendly unit, and position a UnitSelectionBox over it.</comment>
                        <event-block sid="4368589528200321">
                            <conditions>
                                <condition id="-8" name="Is boolean instance variable set" sid="1673412369471616" type="FriendlyBases">
                                    <param id="0" name="Instance variable">IsSelected</param>
                                </condition>
                                <condition id="-11" name="For Each" sid="8041219816053447" type="System">
                                    <param id="0" name="Object">FriendlyBases</param>
                                </condition>
                                <condition id="-13" name="Pick nth instance" sid="8927251382316934" type="System">
                                    <param id="0" name="Object">UnitSelectionBox</param>
                                    <param id="1" name="Instance">loopindex</param>
                                </condition>
                            </conditions>
                            <actions>
                                <action id="-3" name="Set position" sid="8132231047597232" type="UnitSelectionBox">
                                    <param id="0" name="X">FriendlyBases.BBoxLeft - 2</param>
                                    <param id="1" name="Y">FriendlyBases.BBoxTop - 2</param>
                                </action>
                                <action id="-7" name="Set size" sid="1288275508574877" type="UnitSelectionBox">
                                    <param id="0" name="Width">FriendlyBases.BBoxRight - FriendlyBases.BBoxLeft + 4</param>
                                    <param id="1" name="Height">FriendlyBases.BBoxBottom - FriendlyBases.BBoxTop + 4</param>
                                </action>
                            </actions>
                        </event-block>
                    </sub-events>
                </event-group>
            </sub-events>
        </event-group>
        <event-group collapsed="1" description="Moving the mouse to the edge of the window to scroll." sid="623999352849707" title="Scrolling">
            <sub-events>
                <comment>When the mouse is moved to the edge of the screen, scroll in that direction.</comment>
                <variable comment="In pixels per second" constant="1" name="ScrollSpeed" sid="8621110807905758" static="0" type="number">600</variable>
                <event-block sid="7477499813663504">
                    <conditions>
                        <condition id="2" name="Key is down" sid="6513271482021611" type="Keyboard">
                            <param id="0" name="Key">38 (Up arrow)</param>
                        </condition>
                    </conditions>
                    <actions>
                        <action id="-6" name="Scroll to Y" sid="5734501045364756" type="System">
                            <param id="0" name="Y">scrolly - SCROLLSPEED * dt</param>
                        </action>
                    </actions>
                </event-block>
                <event-block sid="4435714793527673">
                    <conditions>
                        <condition id="2" name="Key is down" sid="9035951097191764" type="Keyboard">
                            <param id="0" name="Key">40 (Down arrow)</param>
                        </condition>
                    </conditions>
                    <actions>
                        <action id="-6" name="Scroll to Y" sid="6032577997444639" type="System">
                            <param id="0" name="Y">scrolly + SCROLLSPEED * dt</param>
                        </action>
                    </actions>
                </event-block>
                <event-block sid="1392674491049958">
                    <conditions>
                        <condition id="2" name="Key is down" sid="8582106452386574" type="Keyboard">
                            <param id="0" name="Key">37 (Left arrow)</param>
                        </condition>
                    </conditions>
                    <actions>
                        <action id="-5" name="Scroll to X" sid="5715746833462907" type="System">
                            <param id="0" name="X">scrollx - SCROLLSPEED * dt</param>
                        </action>
                    </actions>
                </event-block>
                <event-block sid="7523897924502998">
                    <conditions>
                        <condition id="2" name="Key is down" sid="7460131933550901" type="Keyboard">
                            <param id="0" name="Key">39 (Right arrow)</param>
                        </condition>
                    </conditions>
                    <actions>
                        <action id="-5" name="Scroll to X" sid="4402194640608288" type="System">
                            <param id="0" name="X">scrollx + SCROLLSPEED * dt</param>
                        </action>
                    </actions>
                </event-block>
            </sub-events>
        </event-group>
        <event-group description="Units shooting and doing damage" sid="2644295899429472" title="Combat">
            <sub-events>
                <comment>When the tank turret shoots, spawn its projectile, some particles for eye candy, and randomly adjust the projectile angle slightly to simulate inaccuracy.</comment>
                <event-block sid="3547298001113685">
                    <conditions>
                        <condition behavior="Turret" id="1" name="On shoot" sid="9109795262737997" type="Tank1Turret" />
                    </conditions>
                    <actions>
                        <action id="0" name="Spawn another object" sid="2380244165317876" type="Tank1Turret">
                            <param id="0" name="Object">TurretFireParticles</param>
                            <param id="1" name="Layer">&quot;Projectiles&quot;</param>
                            <param id="2" name="Image point">1</param>
                        </action>
                        <action id="0" name="Spawn another object" sid="4392171763982105" type="Tank1Turret">
                            <param id="0" name="Object">Tank1Projectile</param>
                            <param id="1" name="Layer">&quot;Projectiles&quot;</param>
                            <param id="2" name="Image point">1</param>
                        </action>
                        <action id="-18" name="Rotate clockwise" sid="1350495957640814" type="Tank1Projectile">
                            <param id="0" name="Degrees">random(-2, 2)</param>
                        </action>
                    </actions>
                </event-block>
                <comment>To stop bullets flying across the entire battlefield, fade them out after they&apos;ve left the turret&apos;s range. The Fade behavior is also set to destroy the object after the fade out.</comment>
                <event-block sid="3691002172180998">
                    <conditions>
                        <condition behavior="Bullet" id="1" name="Compare distance travelled" sid="4464478037492542" type="FriendlyProjectiles">
                            <param id="0" name="Comparison">4</param>
                            <param id="1" name="Distance">Self.Range</param>
                        </condition>
                    </conditions>
                    <actions>
                        <action behavior="Fade" id="1" name="Start fade" sid="9445947025418947" type="FriendlyProjectiles" />
                    </actions>
                </event-block>
                <comment>When the friendly projectile hits an enemy, create an explosion and deal some damage to the enemy.</comment>
                <event-block sid="600931682247169">
                    <conditions>
                        <condition id="0" name="On collision with another object" sid="7278539631965697" type="FriendlyProjectiles">
                            <param id="0" name="Object">EnemyBases</param>
                        </condition>
                    </conditions>
                    <actions>
                        <action id="0" name="Spawn another object" sid="697502965917962" type="FriendlyProjectiles">
                            <param id="0" name="Object">SmallExplosion</param>
                            <param id="1" name="Layer">&quot;Projectiles&quot;</param>
                            <param id="2" name="Image point">0</param>
                        </action>
                        <action id="-9" name="Destroy" sid="7719620152125941" type="FriendlyProjectiles" />
                        <action id="-12" name="Subtract from" sid="1307514579502585" type="EnemyBases">
                            <param id="0" name="Instance variable">Health</param>
                            <param id="1" name="Value">FriendlyProjectiles.Damage</param>
                        </action>
                    </actions>
                </event-block>
                <comment>Destroy any enemies that have run out of health with an explosion.</comment>
                <event-block sid="602869783336114">
                    <conditions>
                        <condition id="-7" name="Compare instance variable" sid="7265553054452704" type="EnemyBases">
                            <param id="0" name="Instance variable">Health</param>
                            <param id="1" name="Comparison">3</param>
                            <param id="2" name="Value">0</param>
                        </condition>
                    </conditions>
                    <actions>
                        <action id="-3" name="Create object" sid="859866031284025" type="System">
                            <param id="0" name="Object to create">BigExplosion</param>
                            <param id="1" name="Layer">&quot;Projectiles&quot;</param>
                            <param id="2" name="X">EnemyBases.X</param>
                            <param id="3" name="Y">EnemyBases.Y</param>
                        </action>
                        <action id="-9" name="Destroy" sid="4663177168432867" type="EnemyBases" />
                    </actions>
                </event-block>
                <comment>These events are the same as above, but simply applying the other way round (for enemies shooting the player&apos;s units).</comment>
                <event-block sid="3666384690432053">
                    <conditions>
                        <condition behavior="Turret" id="1" name="On shoot" sid="3496531023904206" type="Enemy1Turret" />
                    </conditions>
                    <actions>
                        <action id="0" name="Spawn another object" sid="5248214262821252" type="Enemy1Turret">
                            <param id="0" name="Object">TurretFireParticles</param>
                            <param id="1" name="Layer">&quot;Projectiles&quot;</param>
                            <param id="2" name="Image point">1</param>
                        </action>
                        <action id="0" name="Spawn another object" sid="6288964784526854" type="Enemy1Turret">
                            <param id="0" name="Object">Enemy1Projectile</param>
                            <param id="1" name="Layer">&quot;Projectiles&quot;</param>
                            <param id="2" name="Image point">1</param>
                        </action>
                        <action id="-18" name="Rotate clockwise" sid="5232317677826025" type="Enemy1Projectile">
                            <param id="0" name="Degrees">random(-2, 2)</param>
                        </action>
                    </actions>
                </event-block>
                <event-block sid="1312700534567445">
                    <conditions>
                        <condition behavior="Bullet" id="1" name="Compare distance travelled" sid="5780287956173944" type="EnemyProjectiles">
                            <param id="0" name="Comparison">4</param>
                            <param id="1" name="Distance">Self.Range</param>
                        </condition>
                    </conditions>
                    <actions>
                        <action behavior="Fade" id="1" name="Start fade" sid="4356785203277881" type="EnemyProjectiles" />
                    </actions>
                </event-block>
                <event-block sid="9857162948479381">
                    <conditions>
                        <condition id="0" name="On collision with another object" sid="637969743159221" type="EnemyProjectiles">
                            <param id="0" name="Object">FriendlyBases</param>
                        </condition>
                    </conditions>
                    <actions>
                        <action id="0" name="Spawn another object" sid="4683574998498459" type="EnemyProjectiles">
                            <param id="0" name="Object">SmallExplosion</param>
                            <param id="1" name="Layer">&quot;Projectiles&quot;</param>
                            <param id="2" name="Image point">0</param>
                        </action>
                        <action id="-9" name="Destroy" sid="8499889782299617" type="EnemyProjectiles" />
                        <action id="-12" name="Subtract from" sid="9130503386885217" type="FriendlyBases">
                            <param id="0" name="Instance variable">Health</param>
                            <param id="1" name="Value">EnemyProjectiles.Damage</param>
                        </action>
                    </actions>
                </event-block>
                <event-block sid="8938316015146925">
                    <conditions>
                        <condition id="-7" name="Compare instance variable" sid="8765539706425903" type="FriendlyBases">
                            <param id="0" name="Instance variable">Health</param>
                            <param id="1" name="Comparison">3</param>
                            <param id="2" name="Value">0</param>
                        </condition>
                    </conditions>
                    <actions>
                        <action id="-3" name="Create object" sid="2164470843024905" type="System">
                            <param id="0" name="Object to create">BigExplosion</param>
                            <param id="1" name="Layer">&quot;Projectiles&quot;</param>
                            <param id="2" name="X">FriendlyBases.X</param>
                            <param id="3" name="Y">FriendlyBases.Y</param>
                        </action>
                        <action id="-9" name="Destroy" sid="8646748050111755" type="FriendlyBases" />
                    </actions>
                </event-block>
                <comment>The Turret behavior triggers &apos;On shoot&apos; when it&apos;s time to fire, so spawn a projectile in this event.</comment>
                <event-block sid="8078368045367864">
                    <conditions>
                        <condition behavior="Turret" id="1" name="On shoot" sid="2831769615190632" type="Turret" />
                    </conditions>
                    <actions>
                        <action id="0" name="Spawn another object" sid="2329893640160585" type="Turret">
                            <param id="0" name="Object">TurretFireParticles</param>
                            <param id="1" name="Layer">&quot;Projectiles&quot;</param>
                            <param id="2" name="Image point">1</param>
                        </action>
                        <action id="0" name="Spawn another object" sid="3545486315157431" type="Turret">
                            <param id="0" name="Object">Enemy1Projectile</param>
                            <param id="1" name="Layer">&quot;Projectiles&quot;</param>
                            <param id="2" name="Image point">1</param>
                        </action>
                        <action id="-18" name="Rotate clockwise" sid="4248868470812002" type="Enemy1Projectile">
                            <param id="0" name="Degrees">random(-2,2)</param>
                        </action>
                    </actions>
                </event-block>
            </sub-events>
        </event-group>
        <event-group collapsed="1" description="" sid="9282592550759029" title="Enemies">
            <sub-events>
                <comment>To simulate a really basic kind of fake AI, make the enemies pathfind to a random position in the layout every 2 to 25 seconds after arriving at their previous position.</comment>
                <event-block sid="1433970068591195">
                    <conditions>
                        <condition behavior="Timer" id="0" name="On timer" sid="5396819744155298" type="EnemyBases">
                            <param id="0" name="Tag">&quot;patrol&quot;</param>
                        </condition>
                    </conditions>
                    <actions>
                        <action behavior="Pathfinding" id="0" name="Find path" sid="2829904507221106" type="EnemyBases">
                            <param id="0" name="X">random(LayoutWidth)</param>
                            <param id="1" name="Y">random(LayoutHeight)</param>
                        </action>
                    </actions>
                </event-block>
                <event-block sid="558852769711747">
                    <conditions>
                        <condition behavior="Pathfinding" id="0" name="On path found" sid="6403909366681745" type="EnemyBases" />
                    </conditions>
                    <actions>
                        <action behavior="Pathfinding" id="1" name="Move along path" sid="9034642771248334" type="EnemyBases" />
                    </actions>
                </event-block>
                <event-block sid="4930629608383131">
                    <conditions>
                        <condition behavior="Pathfinding" id="5" name="On arrived" sid="6919818596742819" type="EnemyBases" />
                    </conditions>
                    <actions>
                        <action behavior="Timer" id="0" name="Start timer" sid="3911007079668713" type="EnemyBases">
                            <param id="0" name="Duration">random(2,25)</param>
                            <param id="1" name="Type">0</param>
                            <param id="2" name="Tag">&quot;patrol&quot;</param>
                        </action>
                    </actions>
                </event-block>
                <comment>As with the player units, rotate any enemy turrets which don&apos;t have targets back to the direction of their base.</comment>
                <event-block sid="4452162790953736">
                    <conditions>
                        <condition behavior="Turret" id="0" inverted="1" name="Has target" sid="2387032294415843" type="EnemyTurrets" />
                        <condition id="-11" name="For Each" sid="556935269320856" type="System">
                            <param id="0" name="Object">EnemyTurrets</param>
                        </condition>
                        <condition id="-14" name="Pick by unique ID" sid="3711803394035766" type="EnemyBases">
                            <param id="0" name="Unique ID">EnemyTurrets.BaseUID</param>
                        </condition>
                    </conditions>
                    <actions>
                        <action id="-20" name="Rotate toward angle" sid="3628724000204789" type="EnemyTurrets">
                            <param id="0" name="Degrees">EnemyTurrets.Turret.RotateSpeed * dt</param>
                            <param id="1" name="Angle">EnemyBases.Angle</param>
                        </action>
                    </actions>
                </event-block>
            </sub-events>
        </event-group>
        <event-group collapsed="1" description="" sid="370860661121755" title="Misc">
            <sub-events>
                <comment>Destroy explosions after their animations have finished, so they don&apos;t pile up and keep using more memory.</comment>
                <event-block sid="234117909967747">
                    <conditions>
                        <condition id="5" name="On any finished" sid="1880585365296557" type="BigExplosion" />
                    </conditions>
                    <actions>
                        <action id="-9" name="Destroy" sid="6242156765455925" type="BigExplosion" />
                    </actions>
                </event-block>
                <event-block sid="8017602554907642">
                    <conditions>
                        <condition id="5" name="On any finished" sid="4933053866222982" type="SmallExplosion" />
                    </conditions>
                    <actions>
                        <action id="-9" name="Destroy" sid="5973609870105507" type="SmallExplosion" />
                    </actions>
                </event-block>
                <comment>Use the mouse wheel to do a basic zoom effect.</comment>
                <event-block sid="7903521641061399">
                    <conditions>
                        <condition id="8" name="On mouse wheel" sid="8060355448345792" type="Mouse">
                            <param id="0" name="Direction">0</param>
                        </condition>
                        <condition id="-8" name="Compare two values" sid="873612590343893" type="System">
                            <param id="0" name="First value">LayoutScale</param>
                            <param id="1" name="Comparison">4</param>
                            <param id="2" name="Second value">0.75</param>
                        </condition>
                    </conditions>
                    <actions>
                        <action id="-20" name="Set layout scale" sid="2251612799955574" type="System">
                            <param id="0" name="Scale">LayoutScale - 0.1</param>
                        </action>
                    </actions>
                </event-block>
                <event-block sid="8632248319928494">
                    <conditions>
                        <condition id="8" name="On mouse wheel" sid="5709522980898202" type="Mouse">
                            <param id="0" name="Direction">1</param>
                        </condition>
                    </conditions>
                    <actions>
                        <action id="-20" name="Set layout scale" sid="8919745265714188" type="System">
                            <param id="0" name="Scale">LayoutScale + 0.1</param>
                        </action>
                    </actions>
                </event-block>
            </sub-events>
        </event-group>
    </events>
</c2eventsheet>
